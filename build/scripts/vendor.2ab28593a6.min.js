var ctx,$isAndroidCanvas=-1<navigator.userAgent.toLowerCase().indexOf("android"),$isiPhoneCanvas=-1<navigator.userAgent.toLowerCase().indexOf("iphone"),$isiPadCanvas=-1<navigator.userAgent.toLowerCase().indexOf("ipad"),$isiPodCanvas=-1<navigator.userAgent.toLowerCase().indexOf("ipod"),$isMobileCanvas=$isAndroidCanvas||$isiPhoneCanvas||$isiPadCanvas||$isiPodCanvas,viewWidth=window.innerWidth,viewHeight=window.innerHeight,drawingCanvas=document.getElementById("fx-network"),timeStep=.02,time=0,nodes=[],signals=[],signalCount=0,fxNeuralNetwork=function(){initDrawingCanvas(),createNodes(),connectNodes(),transmit(),setInterval(transmit,2e3),requestAnimationFrame(loop)},fxNeuralNetworkUpdate=function(){initDrawingCanvas(),createNodes(),connectNodes(),transmit()};function initDrawingCanvas(){drawingCanvas.width=window.innerWidth,drawingCanvas.height=window.innerHeight,ctx=drawingCanvas.getContext("2d")}function createNodes(){for(var t=1*window.innerWidth-10,n=0;n<15;n++){var i=Math.random()*(2*Math.PI),e=Math.sqrt(Math.random()),s=t*e*Math.cos(i)+.5*window.innerWidth,a=t*e*Math.sin(i)+.5*window.innerWidth;nodes[n]=new Node(s,a)}}function connectNodes(){for(var t,n,i,e=0;e<nodes.length;e++)for(n=0,i=Math.floor(randomRange(2,4));n<i;)t=getRandom(nodes),nodes[e]!==t&&(nodes[e].connections.push(t),n++)}function transmit(){signals.push(new Signal(getRandom(nodes))),signalCount++}function update(){nodes.forEach(function(t){t.update()}),signals.forEach(function(t){!0===t.update()&&signals.splice(signals.indexOf(t),1)})}function draw(){ctx.clearRect(0,0,window.innerWidth,window.innerHeight),nodes.forEach(function(t){t.draw()}),signals.forEach(function(t){t.draw()})}function loop(){update(),draw(),time+=timeStep,requestAnimationFrame(loop)}function Node(t,n){this.x=this._x=t,this.y=this._y=n,this.connections=[],this.r=randomRange(-35,35)}function Signal(t){this.start=t,this.parts=[],this.completeParts=[],this.strength=2,this.jumps=0;var n=Math.floor(360*Math.random());this.style="hsl("+n+",100%,50%)";for(var i=0;i<t.connections.length;i++)this.parts.push(new SignalPart(this.start,this.start.connections[i],this.strength,this.style))}function SignalPart(t,n,i,e){this.start=t,this.end=n,this.strength=i,this.style=e,this._time=0,this.prevTime=0,this.duration=2,this.complete=!1,this.p0={x:0,y:0},this.p1={x:0,y:0}}function randomRange(t,n){return t+Math.random()*(n-t)}function getRandom(t){return t[Math.floor(Math.random()*t.length)]}function lerp(t,n,i,e){return(e=e||{x:0,y:0}).x=t.x+i*(n.x-t.x),e.y=t.y+i*(n.y-t.y),e}Node.prototype={update:function(){this.x=this._x+Math.sin(time)*this.r,this.y=this._y+Math.cos(time)*this.r},draw:function(){ctx.fillStyle="rgba(0,250,200,1)",ctx.lineWidth=.075,ctx.strokeStyle=$isMobileCanvas?"rgba(50,0,250,0)":"rgba(50,0,250,1)",ctx.beginPath(),ctx.arc(this.x,this.y,4,0,2*Math.PI),ctx.fill();for(var t=0;t<this.connections.length;t++)ctx.beginPath(),ctx.moveTo(this.x,this.y),ctx.lineTo(this.connections[t].x,this.connections[t].y),ctx.stroke()}},Signal.prototype={update:function(){var t=!1;this.completeParts.length=0;for(var n=this.parts.length-1;0<=n;n--)this.parts[n].time+=timeStep,this.parts[n].complete&&this.completeParts.push(this.parts.splice(n,1)[0]);if(0<this.completeParts.length&&(this.jumps++,this.strength--,t=3===this.jumps),!1===t)for(var i,e,s=0;s<this.completeParts.length;s++){i=this.completeParts[s].end;for(var a=0;a<i.connections.length;a++)e=i.connections[a],this.parts.push(new SignalPart(i,e,this.strength,this.style))}return t},draw:function(){for(var t=0;t<this.parts.length;t++)this.parts[t].draw()}},SignalPart.prototype={set time(t){this.prevTime=this._time,this._time=t>=this.duration?this.duration:t,this.complete=this._time===this.duration},get time(){return this._time},draw:function(){var t=ease.inOutCubic(this.prevTime,0,1,this.duration),n=ease.outQuad(this.time,0,1,this.duration);lerp(this.start,this.end,t,this.p0),lerp(this.start,this.end,n,this.p1),ctx.strokeStyle=this.style,ctx.lineWidth=.2*this.strength,ctx.lineCap="round",ctx.beginPath(),ctx.moveTo(this.p0.x,this.p0.y),ctx.lineTo(this.p1.x,this.p1.y),ctx.stroke()}};var ease={inCubic:function(t,n,i,e){return i*(t/=e)*t*t+n},outCubic:function(t,n,i,e){return t/=e,i*(--t*t*t+1)+n},inQuad:function(t,n,i,e){return i*(t/=e)*t+n},outQuad:function(t,n,i,e){return-i*(t/=e)*(t-2)+n},inOutCubic:function(t,n,i,e){return(t/=e/2)<1?i/2*t*t*t+n:i/2*((t-=2)*t*t+2)+n}};fxNeuralNetwork(),function(t,n,i){i=i||window;var e=!1;i.addEventListener(t,function(){e||(e=!0,requestAnimationFrame(function(){i.dispatchEvent(new CustomEvent(n)),e=!1}))})}("resize","optimizedResize"),window.addEventListener("optimizedResize",function(){fxNeuralNetworkUpdate()});